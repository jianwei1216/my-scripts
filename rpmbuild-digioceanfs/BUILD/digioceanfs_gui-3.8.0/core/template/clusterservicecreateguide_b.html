$def with (content)

<form id="formclusterservice_b" method="post">
    <fieldset class="createdialog">
        <!--p>$_("clusterservicelocalpro"):</p>
        <ul id="servicelocalpor">
            <li>
                <label for="clusterservicelocalpor_no">$_("no"):</label>
                <input type="radio" id="clusterservicelocalpor_no" name="clusterservicelocalpor" checked onchange="getOthersOff(this);"/>
            </li>
            <li>
                <label for="clusterservicelocalpor_yes">$_("yes"):</label>
                <input type="radio" id="clusterservicelocalpor_yes" name="clusterservicelocalpor" onchange="getOthersOff(this);"/>
            </li>
        </ul-->
        <div>
        <span>$_("clusterservicetype"):</span>
        <select id="serviceraidlv">
        	<option id="clusterservicetype_default">$_("default")</option>
        	<option id="clusterservicetype_afr">$_("afr")</option>
        	<!--option id="clusterservicetype_strip">$_("striped_replicated")</option-->
        	<option id="clusterservicetype_disperse">$_("disperse")</option>
        </select>
        </div>
        <!--ul id="serviceraidlv">
            <li>
                <label for="clusterservicetype_default">$_("default"):</label>
                <input type="radio" id="clusterservicetype_default" name="clusterservicetype" checked onchange="getOthersOff(this);"/>
            </li>
            <li>
                <label for="clusterservicetype_afr">$_("afr"):</label>
                <input type="radio" id="clusterservicetype_afr" name="clusterservicetype" onchange="getOthersOff(this);"/>
            </li>
            <li>
                <label for="clusterservicetype_disperse">$_("disperse"):</label>
                <input type="radio" id="clusterservicetype_disperse" name="clusterservicetype" onchange="getOthersOff(this);"/>
            </li>        
            <!--li>
                <label for="clusterservicetype_strip">$_("striped_replicated"):</label>
                <input type="radio" id="clusterservicetype_strip" name="clusterservicetype" onchange="getOthersOff(this);"/>
            </li-->
        </ul--><br />
        <div id="default_type" class="service_type_info">
	        <table>
	        	<tr id="servicelocalpor">
	                <td class='first'><label for="clusterservicelocalpor">$_("clusterservicelocalpro"):</label></td>
	                <td><input type="checkbox" id="clusterservicelocalpor_default" /></td>
	            </tr>
	        </table>
        </div>
        <div id="afr_type" style="display:none;" class="service_type_info">
        <table>
        	<tr id="servicelocalpor">
                <td class='first'><label for="clusterservicestrip_afrnum">$_("clusterservicelocalpro"):</label></td>
                <td><input type="checkbox" id="clusterservicelocalpor_afr" /></td>
            </tr>
            <tr>
                <td class='first'><label for="clusterserviceafrnum">$_("redundancy"):</label></td>
                <td><input type="text" size="5" id="clusterserviceafrnum" name="clusterserviceafrnum" /></td>
            </tr>
            <!--tr>
                <td class='first'><label>$_("istrip"):</label></td>
                <td>
                    <label for="clusterservicetype_is_strip">$_("yes"):</label>
                    <input type="radio" id="clusterservicetype_strip_yes" name="clusterservicetype_is_strip" />
                    <label for="clusterservicetype_strip_no">$_("no"):</label>
                    <input type="radio" id="clusterservicetype_strip_no" name="clusterservicetype_is_strip" checked/>
                </td>
	    	</tr-->
            <tr id="stripnum" style="display:none;">
                <td class='first'><label for="clusterserviceafr_stripnum">$_("stripnum"):</label></td>
                <td><input type="text" id="clusterserviceafr_stripnum" name="clusterservicestripnum" size="5"/></td>
            </tr>
        </table>
        </div>
        <div id="strip_type" style="display:none;" class="service_type_info">
        <table>
            <tr>
                <td class='first'><label for="clusterservicestripnum">$_("stripnum"):</label></td>
                <td><input type="text" id="clusterservicestripnum" name="clusterservicestripnum" size="5"/></td>
            </tr>
            <tr id="afrnum">
                <td class='first'><label for="clusterservicestrip_afrnum">$_("redundancy"):</label></td>
                <td><input type="text" id="clusterservicestrip_afrnum" name="clusterservicestrip_afrnum" size="5"/></td>
            </tr>
            <tr id="servicelocalpor">
                <td class='first'><label for="clusterservicestrip_afrnum">$_("clusterservicelocalpro"):</label></td>
                <td><input type="checkbox" id="clusterservicelocalpor" name="clusterservicestrip_afrnum" size="5"/></td>
            </tr>
        </table>
        </div>
      	<div id="disperse_type" style="display:none;" class="service_type_info">
        <table>
            <tr>
                <td class='first'><label for="clusterservicedisknum">$_("disknum"):</label></td>
                <td><input type="text" id="clusterservicedisknum" name="clusterservicedisknum" size="5"/></td>
            </tr>
            <tr id="afrnum">
                <td class='first'><label for="clusterservicedispersenum">$_("disperse_num"):</label></td>
                <td><input type="text" id="clusterservicedispersenum" name="clusterservicedispersenum" size="5"/></td>
            </tr>
        </table>
        </div>
        <label>&nbsp;</label>
    </fieldset>
</form>

<script type="text/javascript">
$(ELT)(function(){
    var max = "$content.nodenum";
    //This section used for open hidded afr div
    $(ELT)('#serviceraidlv').live('change',function(){
    	$(ELT)('#formclusterservice_b').validate();
    	var selectObj = $(ELT)(this).children('option:selected');	//选中option对象
    	var defaultDiv = $(ELT)('#default_type');	//默认信息容器对象
    	var afrInfoDiv = $(ELT)('#afr_type');	//冗余信息容器对象
    	//冗余信息验证规则
        var afrnum_rules = {required: true,number: true,min: 2,max: max, messages: {required: '$_("redundancy must not be none")',number: '$_("redundancy must be int")',min: '$_("redundancy must not less than 2")',max: '$_("redundancy must less than node num")'}}
    	var stripeInfoDiv = $(ELT)('#stipe_type');	//分片信息容器对象
    	//分片信息验证规则
    	var stripnum_rules = {required: true,number: true,min: 2, messages: {required: '$_("stripnum must not be none")',number: '$_("stripnum must be int")',min: '$_("stripnum must not less than 2")'}}
        var afrnum_rules = {required: true,number: true,min: 2,max: max, messages: {required: '$_("redundancy must not be none")',number: '$_("redundancy must be int")',min: '$_("redundancy must not less than 2")',max: '$_("redundancy must less than node num")'}}
    	var disperseInfoDiv = $(ELT)('#disperse_type');	//N+M冗余信息容器对象
    	var objID = selectObj.attr('id');
    	switch(objID){
    		case 'clusterservicetype_afr':
    			afrInfoDiv.show().fadeIn('slide');
    			defaultDiv.hide().fadeOut('slide');
    			stripeInfoDiv.hide().fadeOut('slide');
            	disperseInfoDiv.hide().fadeOut('slide');
            	$(ELT)('#clusterserviceafrnum').rules('remove');
            	$(ELT)('#clusterservicestripnum').rules('remove');
           		$(ELT)('#clusterservicestrip_afrnum').rules('remove');
            	$(ELT)('#clusterserviceafrnum').rules('add',afrnum_rules);
    			break;
    		case 'clusterservicetype_strip':
    		    stripeInfoDiv.show().fadeIn('slide');
            	afrInfoDiv.hide().fadeOut('slide');
            	defaultDiv.hide().fadeOut('slide');
            	disperseInfoDiv.hide().fadeOut('slide');
	            $(ELT)('#clusterserviceafrnum').rules('remove');
	            $(ELT)('#clusterservicestripnum').rules('remove');
	            $(ELT)('#clusterservicestrip_afrnum').rules('remove');
	            $(ELT)('#clusterservicestripnum').rules('add',stripnum_rules);
	            $(ELT)('#clusterservicestrip_afrnum').rules('add',afrnum_rules);
    			break;
    		case 'clusterservicetype_disperse':
    			disperseInfoDiv.show().fadeIn('slide');
				//N+M冗余信息验证规则
				//var disknum = $(ELT)('#clusterservicedisknum').val();
    			var disk_rules = {required: true,number: true,min: 3,max: max, messages: {required: '$_("disknum must not be none")',number: '$_("disknum must be int")',min: '$_("disknum must not less than 3")',max: '$_("disknum must less than node num and 23")'}}
    			            
            	afrInfoDiv.hide().fadeOut('slide');
            	stripeInfoDiv.hide().fadeOut('slide');
            	defaultDiv.hide().fadeOut('slide');
            	$(ELT)('#clusterserviceafrnum').rules('remove');
	            $(ELT)('#clusterservicestripnum').rules('remove');
	            $(ELT)('#clusterservicestrip_afrnum').rules('remove');
	            $(ELT)('#clusterservicedisknum').rules('add',disk_rules);
	            $(ELT)('#clusterservicedispersenum').focus(function(){
	            	var disknum = $(ELT)('#clusterservicedisknum').val()
	            	var disperse_rules = {required: true,number: true,min: 1,max: (disknum+1)/2-1, messages: {required: '$_("disperse must not be none")',number: '$_("disperse must be int")',min: '$_("disperse must not less than 1")',max: '$_("disperse must less than 1/2 disknum")'}};
	            	$(ELT)('#clusterservicedispersenum').rules('add',disperse_rules);
	            });
	            //$(ELT)('#clusterservicedispersenum').rules('add',disperse_rules);
    			break;
    		default:
    			defaultDiv.show().fadeIn('slide');
    			afrInfoDiv.hide();
    			stripeInfoDiv.hide();
    			disperseInfoDiv.hide();
    	}
    });
});
</script>

