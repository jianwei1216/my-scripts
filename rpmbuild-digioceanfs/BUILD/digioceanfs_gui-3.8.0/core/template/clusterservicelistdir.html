$def with (content)
<style type="text/css">
	#service_dir{
		border: none;
	}
	.quota_input,.quota_select{
		height:14px;
		width:100px;
		text-align: center;
		font-size: 10px;
	}
	.quota_select{
		width: 50px;
	}
	#quota_unit{
		width: 60px;
	}
	.error{
		color: red;
		border: 1px solid red;
	}
	.unsave{
		background: #d0e5f5;
	}
	.opercommand{
		height: 12px;
		float: none;
		margin-left: 5px;
	}
	.ztree li a:hover{
		text-decoration: none;
	}
	#service_dir_head{
		clear: both;
	}
	#service_dir_head_left, #service_dir_head_right{
		border-bottom: 1px solid #A6C9E2; 
		height: 20px;
		display: inline-block;
		text-algin: bottom;
	    line-height: 20px;
    	margin-bottom: 5px;
    	padding-left: 2px;
    	padding-bottom: 5px;
    	display: inline-block;
	}
	#service_dir_head_left{
		width: 70%;
	}
	#service_dir_head_right{
		width: 28%;
	}
	.qinput {
    	left: 631px;
    	position: absolute;
	}
	.no-unit{
		border: 1px solid red;
	}
</style>

<SCRIPT type="text/javascript">
	var setting = {
		async: {
			enable: true,
			url:"/clusterservicelistdir?" + new Date().getTime(),
			autoParam:["id", "name=n", "level=lv", "path"],
			otherParam:{"otherParam":"zTreeAsyncTest"}
			//dataFilter: filter
		},
		view: {
			addDiyDom: addDiyDom		//添加配额编辑列表
		}
	};

	function addDiyDom(treeId, treeNode) {
		var aObj = $(ELT)("#" + treeNode.tId + "_a");
		var path = treeNode.path;
		var tid = treeNode.path.replace(/\//g,'_');
		if ($(ELT)("#diyBtn_"+treeNode.name).length>0) return;
		if (treeNode.quota_unit == 'GB') var option_str = "<option selected='true'>GB</option><option>TB</option><option>MB</option><option>-</option>";
		if (treeNode.quota_unit == 'TB') var option_str = "<option>GB</option><option selected='true'>TB</option><option>MB</option><option>-</option>";
		if (treeNode.quota_unit == 'MB') var option_str = "<option>GB</option><option>TB</option><option selected='true'>MB</option><option>-</option>";
		if (treeNode.quota_unit == '-') var option_str = "<option>GB</option><option>TB</option><option>MB</option><option selected='true'>-</option>";
		var editStr = "<span id='qinput_space" +tid+ "' class='qinput' > "
			+ "<input type='text' class='quota_input ui-corner-all ui-widget-content' id='quotaInput" + tid
			+ "' title='"+path+"' value='"+treeNode.quota_size+"' disabled='disabled'>"
			+ " <select id='quotaSelect"+tid+"' class='quota_select' disabled='disabled'>"+option_str+"</select>"
			+ "<dl class='opercommand'><dd><a id='edit" + tid +"' class='ui-icon ui-icon-inline ui-icon-pencil' href='javascript:void(0);' title='编辑' >&nbsp;</a></dd><dd><a id='save" + tid +"' class='ui-icon ui-icon-inline ui-icon-disk' href='javascript:void(0);' title='保存'>&nbsp;</a></dd><dd><a id='delete" + tid +"' class='ui-icon ui-icon-inline ui-icon-trash' href='javascript:void(0);' title='删除'>&nbsp;</a></dd></dl></span>";
		var staticStr = "<span id='qinput_space" +tid+ "' class='qinput' > "
			+ "<input type='text' class='quota_input ui-corner-all ui-widget-content' id='quotaInput" + tid
			+ "' title='"+path+"' value='"+treeNode.quota_size+"' disabled='disabled'>"
			+ " <select id='quotaSelect"+tid+"' class='quota_select' disabled='disabled'>"+option_str+"</select>";
		if (treeNode.quota_size == undefined){ 
			aObj.append(staticStr);
			var inputObj = $(ELT)("#quotaInput"+tid);
			var selectObj = $(ELT)("#quotaSelect"+tid);
			var clusterservicename = $(ELT)('#clusterservicelistinput').val();
			getTatolQuota(clusterservicename, inputObj, selectObj);
		}
		else{
			aObj.append(editStr);
		}
		var isNumeric = function(e){
            if (e.shiftKey) return false;
            return (e.keyCode >= 48 && e.keyCode <= 57);
        };
        var isValid = function(e){
        	//TODO
        }
		var bedit = $(ELT)("#edit"+tid);
		var bsave = $(ELT)("#save"+tid);
		var bdel = $(ELT)("#delete"+tid);
		var inputObj = $(ELT)("#quotaInput"+tid);
		var selectObj = $(ELT)("#quotaSelect"+tid);
		if (inputObj) inputObj.bind("click", function(event){ this.focus();event.stopPropagation();});
		if (inputObj) inputObj.bind("keydown", function(e){			
			if (!isNumeric(e)){
				inputObj.addClass('error'); 
			}
			if (!isNaN(inputObj.val())){
				inputObj.removeClass('error');
			}
		});
		if (bdel) bdel.bind("click", function(event){
			var inputVal = inputObj.val();
			var clusterservicename = $(ELT)('#clusterservicelistinput').val();
			var targetpath = inputObj.attr('title')
			clusterservicequotaremove(clusterservicename, targetpath, inputObj, function callback(){
				inputObj.val('-');
				inputObj.attr('disabled','disabled');
				inputObj.removeClass('unsave');
			});
		});
		if (bedit) bedit.bind("click", function(event){
			event.stopPropagation();
			if (selectObj) selectObj.removeAttr('disabled');
			if (inputObj) {
				inputObj.removeAttr('disabled');
				inputObj.select();
				inputObj.focus(function(){
					inputObj.addClass('unsave');
					inputObj.val('');
				});
			}
		});
		if (bsave) bsave.bind("click", function(event){
			event.stopPropagation();
			var inputVal = inputObj.val();
			var clusterservicename = $(ELT)('#clusterservicelistinput').val();
			var targetpath = inputObj.attr('title');
			switch (inputVal){
				case '':
					clusterservicequotaremove(clusterservicename, targetpath, inputObj, function callback(){
						inputObj.val('-');
						inputObj.attr('disabled','disabled');
						inputObj.removeClass('unsave');
					});
					break;
				case '-':
					clusterservicequotaremove(clusterservicename, targetpath, inputObj, function callback(){
						inputObj.attr('disabled','disabled');
						inputObj.removeClass('unsave');
					});
					break;
				default:
					if (isNaN(inputVal)){
						inputObj.addClass('error'); return false;
					}else{
						if (selectObj.val() == '-'){
							selectObj.addClass('no-unit');
							return false;
						}else{
							selectObj.removeClass('no-unit');
							if (!inputObj.attr('disabled') && !selectObj.attr('disabled')){
								//var clusterservicename = $(ELT)('#clusterservicelistinput').val();
								//var targetpath = inputObj.attr('title');
								var value = inputObj.val() + selectObj.val();
								clusterservicequotaset(clusterservicename, targetpath, value, inputObj, function callback(){
									inputObj.attr('disabled','disabled');
									inputObj.removeClass('unsave');
									inputObj.removeClass('error');
								});
							}
							//selectObj.attr('style','color: #fff');
						}
					}					
			}
			if (selectObj) selectObj.attr('disabled','disabled');
		});
	}

	function filter(treeId, parentNode, childNodes) {
		if (!childNodes) return null;
		for (var i=0, l=childNodes.length; i<l; i++) {
			childNodes[i].name = childNodes[i].name.replace(/\.n/g, '.');
		}
		return childNodes;
	}
	$(ELT)("#clusterservicelistinput").bind("change", function(){
		var service_name = $(ELT)("#clusterservicelistinput").val();
		var zNodes = [{'name':service_name,isParent:"true", 'path':'/cluster2/'+service_name}];
		$(ELT).fn.zTree.init($(ELT)("#service_dir"), setting, zNodes);
	});
	var service_name = $(ELT)("#clusterservicelistinput").val();
	var zNodes = [{'name':service_name,isParent:"true", 'path':'/cluster2/'+service_name}];
	$(ELT)(function(){
		$(ELT).fn.zTree.init($(ELT)("#service_dir"), setting, zNodes);
	});
	function getTatolQuota(clusterservicename, targetObj, selectObj){
		var url = '/clusterservicegetsize?'  + new Date().getTime();
		var data = 'clusterservicename=' + clusterservicename;
		$(ELT).ajax({
			url: url,
			type: 'POST',
			data: data,
			dataType: 'JSON',
            beforeSend: function(){
                targetObj.val('$_("setting")');
            },
            success: function(text){
            	result = $(ELT).parseJSON(text);
            	var setting_value = '';
            	var setting_unit = '';
            	setting_value = result['size'];
            	setting_unit = result['unit'] + 'B';
                targetObj.val(setting_value);
                selectObj.html('<option>'+setting_unit+'</option>');
            }
		});
	}
	function clusterservicequotaset(clusterservicename, targetpath, value, targetObj, callback){
		var url = '/clusterservicequotaset?' + new Date().getTime();
		var data = 'clusterservicename=' + clusterservicename +'&targetpath=' + targetpath + '&value=' + value;
		var setting_value = targetObj.val();
		$(ELT).ajax({
			url: url,
			type: 'POST',
			data: data,
			dataType: 'text',
            beforeSend: function(){
                targetObj.val('$_("setting")');
                
            },
            success: function(text){
            	if(isNaN(text)){
                    targetObj.val('$_("failed")');
                }
                else{
                    if(parseInt(text) == 0){
                    	targetObj.val(setting_value);
                    	callback();
                    }else{
                        targetObj.val('$_("failed")');
                    }
                }
            }
		});
	}
	function clusterservicequotaremove(clusterservicename, targetpath, targetObj, callback){
		var url = '/clusterservicequotaremove?' + new Date().getTime();
		var data = 'clusterservicename=' + clusterservicename +'&targetpath=' + targetpath;
		var setting_value = targetObj.val();
		$(ELT).ajax({
			url: url,
			type: 'POST',
			data: data,
			dataType: 'text',
            beforeSend: function(){
                targetObj.val('$_("setting")');
                
            },
            success: function(text){
            	if(isNaN(text)){
                    targetObj.val('$_("failed")');
                }
                else{
                    if(parseInt(text) == 0){
                    	//targetObj.val(setting_value);
                    	callback();
                    }else{
                        targetObj.val('$_("failed")');
                    }
                }
            }
		});
	}
</SCRIPT>

<div id='clusterservicelistdir'>
	<div id='clusterservicelist'>
		<label for="clusterservicelistinput" style="float: none;">$_("clusterservicename")</label>
		<select id="clusterservicelistinput" name="clusterservicelistinput" style="width:90px;">
		$for service in content.clusterservice:
			<option>$service['servicename']</option>
		</select>
	</div><br />
	<div id='service_dir_head'>
		<span id='service_dir_head_left'>$_('directory')</span>
		<span id='service_dir_head_right'>$_('quotasize')</span>
	</div>
	<ul id='service_dir' class='ztree'></ul>
</div>
