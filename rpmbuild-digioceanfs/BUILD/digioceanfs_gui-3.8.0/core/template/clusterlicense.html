$def with (content)

<div id="content">
    <div id="productype">
        <label for="deviceid">$_("productype"):</label>
        <div id="ptype" name="ptype">Digiocean FS8000</div>
    </div>
    <!--<div id="productserialnum">
        <label for="pserial">$_("productserialnum"):</label>
        <div id="pserial" name="pserial">&nbsp</div>
    </div>-->
    <!--<div id="softwareversion">
        <label for="sversion">$_("softwareversion"):</label>
        <div id="sversion" name="sversion">&nbsp</div>
    </div>-->
    <div id="licnodename">
        <label for="nodelist">$_("nodename"):</label>
        <select id="nodelist" name="nodelist" onchange="getDeviceId();">
        </select> 
    </div>
    <div id="licdeviceid">
        <label for="deviceid">$_("deviceid"):</label>
        <input id="deviceid" name="deviceid" type="text" value="" size="32"  readonly />
    </div>
    <div id="liclicense">
        <label for="license">$_("license"):</label>
        <input id="license" name="license" type="text" value="" size="32" maxlength="32" />
        <input type="button" value="$_('create')" onclick="checkLicense();" />
    </div>
</div>

<script type="text/javascript">
    $(ELT)(function(){
        getNodeList();
    });
    function getNodeList(){
        url = "/clustergetnodelist?" + new Date().getTime();
        //checkSession();
		$(ELT).ajax({
			url: url,
			data: '',
			dataType: 'JSON',
			type: 'POST',
			beforeSend: function(){
				custLoading("$_('Loading Data ...')");
			},
			success: function(text){
				$(ELT)('#loaddialog').dialog('close');
				
				nodelist = text;
				if(nodelist.length>0){
					var options_html = '';
					for(var i = 0; i < nodelist.length; i++){
						option_html = '<option value="' + nodelist[i].nodename + '">' + nodelist[i].nodename + '</option>';
						options_html += option_html;
					}
				}else{
					var options_html = '<option>$_("none")</option>';
				}
				$(ELT)('#nodelist').html(options_html);
			},
			complete: function(){
				if($(ELT)('#nodelist').val()&&$(ELT)('#nodelist').val()!='$_("none")'){
					getDeviceId();
				}else{
					$(ELT)("#deviceid").val('');
					$(ELT)("#license").val('');
				}
			}
		});
    }
    function getDeviceId(){
        var url = "/clustergetdeviceid?" + new Date().getTime();
        var nodename = $(ELT)('#nodelist').val();
        checkSession();
        $(ELT).ajax({
            url: url,
            data: 'nodename=' + nodename,
            dataType: 'text',
            type: 'POST',
            beforeSend: function(){
				custLoading("$_('Loading Data ...')");
			},
            success: function(text){
				$(ELT)('#loaddialog').dialog('close');
                if(text != ''){
					var lic_arr=text.split('\t');
                    $(ELT)("#deviceid").val(lic_arr[0]);
					if(lic_arr[1]){
						$(ELT)("#license").val(lic_arr[1]);
					}else{
						$(ELT)("#license").val('');
					}
                }
                else{
                    $(ELT)("#deviceid").val("device id not found!");
                }
            }
        });
    }
    function checkLicense(){
        var url = '/clusterchecklicense?' + new Date().getTime();
        var nodename = $(ELT)("#nodelist").val();
        var license = $(ELT)("#license").val();
        checkSession();
        $(ELT).ajax({
            url: url,
            data: 'nodename=' + nodename + '&license=' + license,
            type: 'POST',
            dataType: 'text',
            beforeSend: function(){
				custLoading("$_('Loading Data ...')");
			},
            success: function(text){
                    if(isNaN(text)){
                        $(ELT)('#loaddialog').dialog('close');
                        custAlert("$_('operfail')",text);
                    }
                    else{
                        if(parseInt(text) == 0){
                            $(ELT)('#loaddialog').dialog('close');
                            custAlert("$_('opersucc')","$_('clusternodechecklicensesucc')");
                        }
                        else{
							$(ELT)('#loaddialog').dialog('close');
                            custAlert("$_('operfail')","$_('operfailinfo')");
                        }
                    }
            }
        });
    }
</script>
